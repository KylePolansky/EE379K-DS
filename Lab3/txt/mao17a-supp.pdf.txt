“On Mixed Memberships and Symmetric Nonnegative Matrix Factorizations”

Appendix for

Xueyu Mao 1 Purnamrita Sarkar 2 Deepayan Chakrabarti 3

A. Identiﬁability
Lemma A.1. (Lemma 1.1 of (Minc, 1988)) The inverse of a nonnegative matrix matrix M is nonnegative if and only if
M is a generalized permutation matrix.

Proof of Theorem 2.1. Suppose there are two parameter settings (Θ(1), B(1), ρ(1)) and (Θ(2), B(2), ρ(2)) that yield the
same probability matrix:

P = ρ(1)Θ(1)B(1)Θ(1)T

= ρ(2)Θ(2)B(2)Θ(2)T

.

Pick up pure node indices set I1 of Θ(1) such that Θ(1)I1
set I2 of Θ(2) such that Θ(2)I2
= I, and let W = Θ(1)I2
.
Then

= I, and denote M = Θ(2)I1

. Similarly, pick up pure node indices

ρ(1)B(1) = ρ(2)MB(2)MT and ρ(1)WB(1)WT = ρ(2)B(2).

Denote T = MW, then

B(1) =

1
ρ(1)

Mρ(1)WB(1)WT MT = TB(1)TT .

(1)

Note that M · 1 = Θ(2)I1
matrix of a Markov chain, whose states are the nodes of the graph. Keep applying equation (1) to its RHS, we get

· 1 = 1, so T · 1 = MW · 1 = 1. We can consider T as a transition

· 1 = 1 and W · 1 = Θ(1)I2

which implies B(1) = T∞B(1)TT∞, where T∞ = lim

k→∞ Tk.

B(1) = TkB(1)TkT

,

Given that B(1) has full rank K, we must have T∞ has full rank. Now we prove that stationary point of the Markov chain,
T∞, must be identity matrix.
The nodes of a ﬁnite-size Markov chain can be split into a ﬁnite number of communication classes, and possibly some
transient nodes.

1. If a communication class has at least two nodes and is aperiodic, then the rows corresponding to those nodes in T∞

are the stationary distribution for that class. Hence, T∞ has identical rows, so it cannot be full rank.

2. The probability of a Markov chain ending in a transient node goes to zero as the number of iterations k grows, so the
column of T∞ corresponding to any transient node is identically zero. Again, this means that T∞ cannot be full rank.

1Department of Computer Science. 2Department of Statistics and Data Sciences. 3Department of Information, Risk, and Operations
Management. The University of Texas at Austin, TX, USA. Correspondence to: Xueyu Mao <xmao@cs.utexas.edu>, Purnamrita
Sarkar <purna.sarkar@austin.utexas.edu>, Deepayan Chakrabarti <deepay@utexas.edu>.

Proceedings of the 34 th International Conference on Machine Learning, Sydney, Australia, PMLR 70, 2017. Copyright 2017 by the
author(s).

On Mixed Memberships and Symmetric Nonnegative Matrix Factorizations

Hence, the only conﬁguration in which T∞ has full rank is when it contains K communication classes, each with one
node. This implies that T∞ = I, and hence T = I. Note that if the communication classes are periodic, we can consider
Tt where t is the product of the periods of all the classes; the matrix Tt is now aperiodic for all the communication classes,
and the above argument still applies to T∞ = lim
As I = T = MW, M and W have full rank, then M−1 = W, which is the case that a nonnegative matrix M has
nonnegative inverse W, using Lemma A.1, we know that M is a generalized permutation matrix, and note that each row
of M sums to 1, the scale goes away and thus M is a permutation matrix, which implies W is also a permutation matrix.
As largest element of B(1) and B(2) are equals as 1, we should have ρ(1) = ρ(2) and thus B(1) = MB(2)MT .
Also since we have

k→∞(Tt)k.

ρ(1)B(1)Θ(1)T

left multiply(cid:0)ρ(1)B(1)(cid:1)−1 on both sides, we have Θ(1) = Θ(2)MT .

B(1)Θ(1)T

= ρ(1)Θ(1)I1
= ρ(2)MB(2)MT MΘ(2)T

= ρ(2)Θ(2)I1

B(2)Θ(2)T

= ρ(2)MB(2)Θ(2)T

= ρ(1)B(1)MΘ(2)T

,

Thus we have shown that MMSB is identiﬁable up to a permutation.

B. Uniqueness of SNMF for MMSB networks
Lemma B.1 (Huang et al. (2014)). If rank(P) = K, the Symmetric NMF P = WWT is unique if and only if the non-
negative orthant is the only self-dual simplicial cone A with K extreme rays that satisﬁes cone(WT ) ⊆ A = A∗, where
A∗ is the dual cone of A, deﬁned as A∗ = {y|xT y ≥ 0,∀x ∈ A}.

Proof of Theorem 2.2. When B is diagonal, it has a square root C = B1/2, where C is also a positive diagonal matrix. It
is easy to see that cone(C) is the non-negative orthant RK

+ , so we have

cone(WT ) = cone(CT ΘT ) = cone(CT ) = cone(C) = RK

+ = RK

+

∗

.

+ ⊆ A and A = A∗ ⊆(cid:0)RK

The second equality follows from the fact that Θ contains all pure nodes, and other nodes are convex combinations of these
pure nodes. The fourth equality is due to the diagonal form of C.
To see that this is unique, suppose there is another self-dual simplicial cone satisfying cone(WT ) ⊆ A = A∗. Then we
have RK
Hence, by Lemma B.1, an identiﬁable MMSB model with a diagonal B is sufﬁcient for the Symmetric NMF solution to
be unique and correct.

+ , which implies A = RK
+ .

= RK

(cid:1)∗

+

C. Concentration of the Laplacian
We will use X = c(1 ± ) to denote X ∈ c[1 − , 1 + ] for ease of notation from now onwards.
Lemma C.1. For Θ ∈ Rn×K, where each row θi ∼ Dirichlet(α), ∀j ∈ [K],

n(cid:88)

(cid:32)

(cid:32)(cid:115)

(cid:33)(cid:33)

θij = n

αj
α0

1 ± OP

α0
αj

log n

n

with probability larger than 1 − 1/n3.

i=1

Proof. By using Chernoff bound

(cid:16)

so by setting  = OP

3

(cid:113) log n

nαj /α0

P

(cid:17)

,

(cid:32)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12) n(cid:88)
(cid:12)(cid:12)(cid:12)(cid:80)n

i=1

θij − n

αj
α0
i=1 θij − n αj

α0

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12) > n
(cid:33)
(cid:12)(cid:12)(cid:12) ≤ 3
(cid:113) αj

αj
α0

α0

(cid:32)
− 2n αj

α0

3

(cid:33)

,

≤ exp

n log n, with probability larger than 1 − 1/n3.

That is

On Mixed Memberships and Symmetric Nonnegative Matrix Factorizations

n(cid:88)

i=1

θij = n

± OP

αj
α0

(cid:18)(cid:114) αj

α0

(cid:19)

n log n

= n

(cid:32)(cid:115)

(cid:32)

1 ± OP

αj
α0

α0
αj

log n

n

(cid:33)(cid:33)

.

Lemma C.2. (Theorem 5.2 of (Lei et al., 2015)) Let A be the adjacency matrix of a random graph on n nodes in which
edges occur independently. Set E[A] = P and assume that n maxi,j Pij ≤ d for d ≥ c0 log n and c0 > 0. Then, for any
r > 0 there exists a constant C = C(r, c0) such that:

P((cid:107)A − P(cid:107) ≤ C

d) ≥ 1 − n−r.

√

F ≤ k(cid:107)M(cid:107)2.

Fact C.1. If M is rank k, then (cid:107)M(cid:107)2
Lemma C.3. (Variant of Davis-Kahan (Yu et al., 2015)). Let P, ˆA ∈ Rn×n be symmetric, with eigenvalues λ1 ≥ ··· ≥ λn
and ˆλ1 ≥ ··· ≥ ˆλn respectively. Fix 1 ≤ r ≤ s ≤ n, and assume that min(λr−1 − λr, λs − λs+1) > 0, where we deﬁne
λ0 = ∞ and λn+1 = −∞. Let d = s − r + 1, and let V = (vr, vr+1,··· , vs) ∈ Rn×d and ˆV = (ˆvr, ˆvr+1,··· , ˆvs) ∈
Rn×d have orthonormal columns satisfying Pvj = λjvj and ˆAˆvj = ˆλj ˆvj for j = r, r + 1,··· , s. Then there exists an
orthogonal matrix ˆO ∈ Rd×d such that

(cid:13)(cid:13)(cid:13) ˆV − V ˆO
(cid:13)(cid:13)(cid:13)F

(cid:16)

d1/2(cid:13)(cid:13)(cid:13) ˆA − P
(cid:13)(cid:13)(cid:13) ,

(cid:13)(cid:13)(cid:13) ˆA − P
(cid:13)(cid:13)(cid:13)F

(cid:17)

min(λr−1 − λr, λs − λs+1)

≤ 23/2 min

Lemma C.4. (Lemma A.1. of (Tang et al., 2013)). Let H1, H2 ∈ Rn×n be positive semideﬁnite with rank(H1) =
rank(H2) = K. Let X, Y ∈ Rn×K be of full column rank such that XXT = H1 and YYT = H2. Let λK (H2)) be the
smallest nonzero eigenvalue of H2. Then there exists an orthogonal matrix R ∈ RK×K such that:

Lemma C.5. Recall that ˆA1 = ˆV1 ˆE1 ˆVT

1 and P1 = P(S,S) in Algorithm 1. If ρn = Ω(log n), then

√

K (cid:107)H1 − H2(cid:107)(cid:16)(cid:112)(cid:107)H1(cid:107) +(cid:112)(cid:107)H2(cid:107)(cid:17)
= OP ((cid:112)Kρn)

(cid:13)(cid:13)(cid:13) ˆA1 − P1

ρn), and

λK (H2)

(cid:13)(cid:13)(cid:13)F

.

(cid:107)XR − Y(cid:107)F ≤

(cid:13)(cid:13)(cid:13) ˆA1 − P1

(cid:13)(cid:13)(cid:13) = OP (

√

with probability larger than 1 − 1/n3.

2 ] has (cid:96)1 norm 1 and all nonnegative elements for

Proof. Lemma C.2 gives the spectral bound of binary symmetric random matrices, in our model,
j ≤ ρ

ρθiIθT

j ≤ n
2

max
i,j

n
2

n
2

.

n
2

P1(i, j) ≤ n
2

max
i,j

max
i,j

P(i, j) =

ρθiBθT
Note that we need to use B is diagonal probability matrix and θi, i ∈ [ n
the last two inequality.
Since ρn = Ω(log n), ∃c0 ≥ 0 that ρ n
Let d = ρ n

2 , then d ≥ n

max
i,j

2 ≥ c0 log n
2 .
(cid:18)

2 maxi,j P1(i, j) and d ≥ c0 log n
(cid:107)A1 − P1(cid:107) ≤ C

P

ρ

(cid:114)
2 , by Lemma C.2, ∀r ≥ 0, ∃ C > 0 that

(cid:19)

n
2

≥ 1 − (

)−r,

n
2

√
where A1 = A(S,S). So (cid:107)A1 − P1(cid:107) = OP (

Hence(cid:13)(cid:13)(cid:13) ˆA1 − P1

(cid:13)(cid:13)(cid:13) ≤(cid:13)(cid:13)(cid:13) ˆA1 − A1 + A1 − P1

(cid:13)(cid:13)(cid:13) ≤(cid:13)(cid:13)(cid:13) ˆA1 − A1

(cid:13)(cid:13)(cid:13) + (cid:107)A1 − P1(cid:107) = ˆσK+1 + OP (

ρn), specially, taking r = 3 then it is with probability larger than 1−1/n3.

√

√
ρn) = OP (

ρn),

On Mixed Memberships and Symmetric Nonnegative Matrix Factorizations

where ˆσK+1 is the (K + 1)-th eigenvalue of A1 and is OP (
Since ˆA1 and P1 have rank K, then by Fact C.1,

(cid:13)(cid:13)(cid:13) ˆA1 − P1

(cid:13)(cid:13)(cid:13)F

√

≤

2K

ρn) by Weyl’s inequality.

(cid:13)(cid:13)(cid:13) ˆA1 − P1

(cid:13)(cid:13)(cid:13) = OP ((cid:112)Kρn).

√

Lemma C.6 (Concentration of degrees). Denote βmin = mina Baa. Let P = ρΘ(1)BΘ(2)T , where ρ, B, Θ(1) ∈ R n
and Θ(2) ∈ R n
and population node degrees. Then

2 ×K,
2 ×K follow the restrictions of MMSB model. Let D and D be diagonal matrices representing the sample

Dii = OP (ρn/K), Dii = Ω(βminρn/K), and |Dii − Dii| = OP ((cid:112)ρn log n/K)

with probability larger than 1 − OP (1/n3).
Proof. ∀i ∈ [ n

2 ], we have

Dii =

Pij =

ρθ(1)

i(cid:96) B(cid:96)(cid:96)θ(2)

n/2(cid:88)
(cid:80)K
(cid:32)

j=1

= ρn

=

ρn
2K

n/2(cid:88)

j=1

K(cid:88)
(cid:32)
(cid:32)(cid:114)

(cid:96)=1

1
2

(cid:96)=1 θ(1)

i(cid:96) αl

α0

1 + OP

+ OP

K log n

n

n/2(cid:88)
(cid:33)(cid:33)

j=1

ρθ(1)
i(cid:96)

j(cid:96) ≤ K(cid:88)
(cid:32)(cid:114) α0
(cid:33)(cid:33)

αl

(cid:96)=1

n

log n

K(cid:88)

(cid:96)=1

θ(1)
i(cid:96)

n/2(cid:88)

j=1

θ(2)
j(cid:96) = ρ

θ(2)
j(cid:96)

(maxa Baa = 1 by deﬁnition)

(from Lemma C.1)

(when αk = α0

K ,∀k ∈ [K])

so Dii = OP (ρn/K).
Similarly,

Dii ≥ K(cid:88)

(cid:96)=1

,

n/2(cid:88)

j=1

βminρθ(1)
i(cid:96)

θ(2)
j(cid:96) = βminρ

(cid:80)K
(cid:32)

(cid:32)
(cid:32)(cid:114)

= βminρn

(cid:96)=1 θ(1)

i(cid:96) αl

α0

=

βmin
2K

ρn

1 + OP

1
2

+ OP

K log n

n

θ(1)
i(cid:96)

K(cid:88)
(cid:32)(cid:114) α0
(cid:33)(cid:33)

αl

(cid:96)=1

,

n/2(cid:88)

j=1

log n

n

θ(2)
j(cid:96)

(cid:33)(cid:33)

(from Lemma C.1)

(when αl = α0

K ,∀l)

so Dii = Ω(βminρn/K).
Then using Chernoff bound, we have

(cid:16)

(cid:113) K log n

(cid:17)

P (|Dii − Dii| > Dii]) ≤ exp

, |Dii − Dii| ≤ Dii = OP ((cid:112)ρn log n/K) with probability at least 1 − 1/n3. Note we

3

,

so when  = OP
have used Lemma C.1, so in total it is with probability larger than 1 − OP (1/n3).

ρn

3

(cid:18)
− 2Dii

(cid:19)

Lemma C.7. Denote βmin = mina Baa. If ρn = Ω(log n), then

λK(P1) = Ω(βminρn/K),

λ1(P1) = OP (ρn/K)

and

with probability larger than 1 − OP (K 2/n3).

λK(A1) = Ω(βminρn/K),

λ1(A1) = OP (ρn/K)

On Mixed Memberships and Symmetric Nonnegative Matrix Factorizations

Proof. For conciseness, we will omit the subscript 1 (see Lemma C.5) in the following proof without loss of generality.
The K-th eigenvalue of P is

λK(P) = λK(ρΘBΘT ) = λK(ρΘB1/2B1/2ΘT ) = λK(ρB1/2ΘT ΘB1/2).

Here we consider θi as a random variable. Denote

ˆM =

1

n/2

ρB1/2ΘT ΘB1/2 =

n/2(cid:88)

i=1

1

n/2

ρB1/2θT

i θiB1/2,

(cid:80)n/2

√

then ˆMab = 1
n/2
Consider θi ∼ Dirichlet(α), then

βaβb

i=1 ρθiaθib.

(cid:40)

Cov[θia, θib] + E[θia] · E[θib] = αaαb
Var[θia] + E2[θia] = αa(αa+1)
α0(α0+1) ,

α0(α0+1) ,

if a (cid:54)= b
if a = b

E[θia · θib] =

√

so E[ ˆMab] =

βaβbρE[θia · θib] ≤ ρ. And

E[ ˆM] = ρ(diag(Bα) + B1/2ααT B1/2)/(α0(α0 + 1)).

Using Chernoff bound, we have

(cid:18)

(cid:33)

2 E[ ˆMab]

(cid:19)
(cid:12)(cid:12)(cid:12) > E[ ˆMab]
(cid:17) ≤ exp
(cid:12)(cid:12)(cid:12) ≤ E[ ˆMab] with probability larger than 1 − 1/n3. Thus
(cid:13)(cid:13)(cid:13)F
(cid:13)(cid:13)(cid:13) ≤(cid:13)(cid:13)(cid:13) ˆM − E[ ˆM]

(cid:32)
− 2 n
(cid:113)

K 22E2[ ˆMab] ≤ Kρ.

− 2ρn
6

≤ exp

≤

3

,

so when  = OP

Note that

,

ρn

P

(cid:16)(cid:12)(cid:12)(cid:12) ˆMab − E[ ˆMab]
(cid:12)(cid:12)(cid:12) ˆMab − E[ ˆMab]
(cid:16)(cid:113) 18 log n
(cid:17)
(cid:13)(cid:13)(cid:13) ˆM − E[ ˆM]
(cid:16)
(cid:16)

≥ ρ

λK(E[ ˆM]) = ρλK(diag(Bα) + B1/2ααT B1/2)/(α0(α0 + 1))

λK(diag(Bα)) + λK(B1/2ααT B1/2)

= ρ

min

βaαa + 0

/(α0(α0 + 1))

(cid:17)

(cid:17)

/(α0(α0 + 1))

(when αa = α0

K ,∀a)

a

= ρ

=

mina βaαa
α0(α0 + 1)
βminρ

,

K(α0 + 1)

(cid:12)(cid:12)(cid:12)λK( ˆM) − λK(E[ ˆM])

the ﬁrst inequality is by deﬁnition of the smallest eigenvalue and property of min function; the second equality is by the
smallest eigenvalue of a K × K rank-1 matrix (K > 1) is 0.
By Weyl’s inequality,

so

λK(P) =

n
2

λK( ˆM) ≥ n
2

(cid:12)(cid:12)(cid:12) ≤(cid:13)(cid:13)(cid:13) ˆM − E[ ˆM]
(cid:32)

βminρ

K(α0 + 1)

(cid:32)
(cid:13)(cid:13)(cid:13) = OP
(cid:32)

− OP

K

K

(cid:114)
(cid:114)

ρ log n

n

ρ log n

n

(cid:33)
(cid:33)(cid:33)

,

On Mixed Memberships and Symmetric Nonnegative Matrix Factorizations

with probability larger than 1 − K 2/n3, and thus λK(P) = Ω(βminρn/K).
With similar argument we can get

(cid:16)

(cid:17)

λ1(E[ ˆM]) ≤ ρ

1 +

(cid:107)β(cid:107)1

α0
K

/(K(α0 + 1))

≤ ρ (1 + α0) /(K(α0 + 1))
=

,

ρ
K

then λ1 (P) = OP (ρn/K).
From Weyl’s inequality, we have

|λi(A) − λi(P)| ≤ (cid:107)A − P(cid:107) = OP (

√

ρn) ,

so

√
λK(A) ≥ λK(P) − OP (
√
λ1(A) ≤ λK(P) + OP (

ρn) =⇒ λK(A) = Ω(βminρn/K)
ρn) =⇒ λ1(A) = OP (ρn/K) .

Lemma C.8. If ρn = Ω(log n), ∃ orthogonal matrix ˆO1 ∈ RK×K,

(cid:13)(cid:13)(cid:13) ˆV1 − V1 ˆO1

(cid:13)(cid:13)(cid:13)F

= OP

(cid:19)

(cid:18) K 3/2

√

βmin

ρn

with probability larger than 1 − OP (K 2/n3).

Proof. From Lemma C.7 we know that

λK(P1) = Ω(βminρn/K)

with probability larger than 1 − OP (K 2/n3). Because P1 has rank K, its K + 1 eigenvalue is 0, and the gap between
the K-th and (K + 1)-th eigenvalue of P1 is δ = Ω(βminρn/K). Using variant of Davis-Kahan’s theorem (Lemma C.3),
setting r = 1, s = K, then d = K is the interval corresponding to the ﬁrst K principle eigenvalues of P1, we have
∃ ˆO1 ∈ RK×K,

(cid:16)√

K

≤ 23/2 min

(cid:18) 23/2√

Kρn
βminρn/K

= OP

(cid:17)

,

(cid:13)(cid:13)(cid:13) ,

(cid:13)(cid:13)(cid:13) ˆA1 − P1
(cid:19)

δ

= OP

(cid:13)(cid:13)(cid:13) ˆA1 − P1
(cid:18) K 3/2

(cid:13)(cid:13)(cid:13)F
(cid:19)

√

βmin

ρn

using Lemma C.5,

(cid:13)(cid:13)(cid:13)F
(cid:13)(cid:13)(cid:13) ˆV1 − V1 ˆO1
(cid:13)(cid:13)(cid:13)F
(cid:13)(cid:13)(cid:13) ˆV1 − V1 ˆO1

with probability larger than 1 − OP (K 2/n3).

Lemma C.9. If ρn = Ω(log n), then the orthogonal matrix ˆO1 ∈ RK×K of Lemma C.8 satisﬁes

(cid:13)(cid:13)(cid:13) ˆE1 − ˆOT

1 E1 ˆO1

(cid:13)(cid:13)(cid:13)F

= OP ((cid:112)Kρn/βmin)

with probability larger than 1 − OP (K 2/n3).

On Mixed Memberships and Symmetric Nonnegative Matrix Factorizations

1

=

Proof. We have

with probability larger than 1 − 1/n3 by Lemma C.5, and

= OP
with probability larger than 1 − OP (K 2/n3) by Lemma C.8. Also,
1 + ˆV1 ˆOT

1 − V1E1VT

ˆV1 ˆE1 ˆVT

1 − V1E1VT

(cid:13)(cid:13)(cid:13) ˆV1 ˆE1 ˆVT

(cid:13)(cid:13)(cid:13)F
(cid:13)(cid:13)(cid:13) ˆV1 − V1 ˆO1
(cid:13)(cid:13)(cid:13)F
(cid:16) ˆE1 − ˆOT
(cid:17) ˆVT
(cid:13)(cid:13)(cid:13) ˆV1
(cid:13)(cid:13)(cid:13) ˆE1 − ˆOT
(cid:13)(cid:13)(cid:13)F
(cid:16) ˆE1 − ˆOT
(cid:17) ˆVT
(cid:13)(cid:13)(cid:13) ˆV1 ˆOT
(cid:13)(cid:13)(cid:13)F
≤(cid:13)(cid:13)(cid:13) ˆV1 ˆE1 ˆVT
(cid:16) ˆO1 ˆVT
≤OP ((cid:112)Kρn) + 2(cid:107)E1(cid:107)(cid:13)(cid:13)(cid:13) ˆV1 − V1 ˆOT
(cid:13)(cid:13)(cid:13)F
(cid:19)
(cid:18) ρn
=OP ((cid:112)Kρn) + OP
(cid:17)
(cid:16)(cid:112)Kρn/βmin

1 E1 ˆO1
=
1 − V1E1VT

· K 3/2
√
βmin

1 = ˆV1

1 E1 ˆO1

1 E1 ˆO1

=OP

1 E1

So

ρn

K

+

1

1

1

,

ρn

√

βmin

(cid:13)(cid:13)(cid:13)F
(cid:13)(cid:13)(cid:13) ˆA1 − P1
= OP ((cid:112)Kρn)
(cid:18) K 3/2
(cid:19)
(cid:16) ˆO1 ˆVT
(cid:17)(cid:13)(cid:13)(cid:13)F

(cid:13)(cid:13)(cid:13)(cid:16) ˆV1 ˆOT

1 − VT

1 − VT

(cid:13)(cid:13)(cid:13)F

(cid:17)

1 E1

+

1

1

+

(cid:17)

E1VT
1 .

1 − V1

(cid:16) ˆV1 ˆOT
(cid:17)

(cid:13)(cid:13)(cid:13)F

1 − V1

E1VT
1

with probability larger than 1 − OP (K 2/n3).
Lemma C.10. If ρn = Ω(log n), then ∃ an orthogonal matrix R1 ∈ RK×K, together with the orthogonal matrix ˆO ∈
RK×K of Lemma C.8 satisﬁes

(cid:16)

(cid:17)

= OP

K 3/2/β2

min

with probability larger than 1 − OP (K 2/n3).

Proof. From Lemma C.9 we have

(cid:13)(cid:13)(cid:13) ˆO1 ˆE1 ˆOT

1 − E1
with probability larger than 1 − OP (K 2/n3).
By Lemma C.4, there exists an orthogonal matrix R1 ∈ Rd×d such that:

1 E1 ˆO1

=

(cid:13)(cid:13)(cid:13) ˆO1 ˆE1/2

1 R1 − E1/2

1

≤

(cid:13)(cid:13)(cid:13)F

(cid:17)

.

= OP

(cid:13)(cid:13)(cid:13)F

(cid:16)(cid:112)Kρn/βmin
(cid:13)(cid:13)(cid:13)(cid:18)(cid:114)(cid:13)(cid:13)(cid:13) ˆO1 ˆE1 ˆOT
(cid:19)
(cid:13)(cid:13)(cid:13) +(cid:112)(cid:107)E1(cid:107)
(cid:1)(cid:1)
(cid:1) + OP
(cid:0)(cid:112) ρn
(cid:1)(cid:0)OP
(cid:0)(cid:112) ρn

λK(E)

1

K

K

Ω(βminρn/K)

(cid:13)(cid:13)(cid:13)R1E1/2

1

Note that

so

ˆO1 − ˆE1/2

1 − RT

ˆE1/2

1

ˆOT
1

=

(cid:13)(cid:13)(cid:13)F
(cid:16)

(cid:13)(cid:13)(cid:13) ˆO1 ˆE1/2
1 R1 − E1/2
(cid:17)

1

ˆO1 − ˆE1/2

1

= OP

K 3/2/β2

min

.

ˆO1 − ˆE1/2

1

(cid:13)(cid:13)(cid:13)F
(cid:13)(cid:13)(cid:13) ˆE1 − ˆOT

1

√

(cid:13)(cid:13)(cid:13)R1E1/2
(cid:13)(cid:13)(cid:13)F
(cid:13)(cid:13)(cid:13) ˆO1 ˆE1 ˆOT
(cid:0)√
(cid:16)
(cid:13)(cid:13)(cid:13)F
(cid:13)(cid:13)(cid:13)R1E1/2

K · OP

(cid:13)(cid:13)(cid:13)E1/2

K 3/2/β2

√

K

=

1

1

≤
≤ OP

1 − E1

Kρn/βmin

(cid:17)

min

.

1

(cid:13)(cid:13)(cid:13)F

(from Lemma C.7)

(cid:13)(cid:13)(cid:13)F

,

On Mixed Memberships and Symmetric Nonnegative Matrix Factorizations

Proof of Lemma 4.1. Note that if α = u1, u > 0, then

D21(i, i) =

ρθiaBaaθja =

ρθiaBaa

(cid:88)

a∈[K],j∈S

(cid:88)

a∈[K]

(cid:88)

j∈S

θja =

ρn
2K

(cid:32)

1 ± OP

(cid:32)(cid:114)

θiaBaa

(cid:88)

a∈[K]

(cid:33)(cid:33)

K log n

.

n
(by Lemma C.1)

Because

(cid:13)(cid:13)(cid:13)√

ρ · eT

i D−1/2

21 Θ2B1/2(cid:13)(cid:13)(cid:13)2

F

=

=

i Θ2B1/2(cid:13)(cid:13)2
ρ(cid:13)(cid:13)eT
(cid:80)
(cid:80)

D21(i, i)
·

2K
n

F

a∈[K] θ2
iaBaa
a∈[K] θiaBaa

(cid:34)

∈ ρ(cid:80)
(cid:80)
1 + OP ((cid:112)K log n/n)
(cid:104)
1 − OP ((cid:112)K log n/n), 1 + OP ((cid:112)K log n/n)

a∈[K] θ2
iaBaa
a∈[K] θiaBaa

ρn
2K

1

,

1

1 − OP ((cid:112)K log n/n)
(cid:105)

,

(cid:35)

also note that

(cid:80)
(cid:80)

a∈[K] θ2
iaBaa
a∈[K] θiaBaa

·

2K
n

≤ 2K
n

· max

a

θia ≤ 2K
n

,

where the ﬁrst inequality is an equality when ∀k ∈ [K], θik = maxa θia or 0. The second inequality becomes an equality
when maxa θia = 1 (i.e. i is a pure node). This implies that the LHS of the above equation equals 2K/n if and only if i
corresponds to a pure node. Then we have

and

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:13)(cid:13)(cid:13)√

ρ · eT

i D−1/2

ρ · eT

i D−1/2

(cid:13)(cid:13)(cid:13)√
21 Θ2B1/2(cid:13)(cid:13)(cid:13)2

21 Θ2B1/2(cid:13)(cid:13)(cid:13)2
(cid:80)
(cid:80)

− 2K
n

·

F

F

≤ 2K
n

· max

a

θia

a∈[K] θ2
iaBaa
a∈[K] θiaBaa

(cid:16)

,

(cid:17)
1 + OP ((cid:112)K log n/n)
(cid:80)
· OP ((cid:112)K log n/n)
(cid:80)
(cid:19)
(cid:18) 2K

a∈[K] θ2
iaBaa
a∈[K] θiaBaa

·(cid:112)K log n/n

·

2K
n

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12) =

= OP

n

with probability larger than 1 − O(1/n3).

(cid:13)(cid:13)(cid:13)√

21 Θ2B1/2(cid:13)(cid:13)(cid:13)2

ρ · eT

i D−1/2

So
nodes have maxa θia bounded away from one, and hence have norm bounded away from 2K/n.

concentrates around 2K

n for pure nodes. Note that we implicitly assume that the impure

F

.

Proof of Theorem 4.2. Denote Θ1 = Θ(S, :) and Θ2 = Θ( ¯S, :). Denote A12 = A(S, ¯S) and A21 = A( ¯S,S), D12
−1/2
and D21 are the (row) degree matrix of A12 and A21. GeoNMF projects D
12 A12 onto
−1/2
ˆV2 ˆE
2
Now, V1E1VT
such that V1E1/2
Also, as shown in Lemmas C.8 and C.10, there exists orthogonal matrices ˆO1 and and R1 such that

1 , with both E1 and B diagonal. This imples that there exists an orthogonal matrix Q1

ρ · Θ1B1/2 (by Lemma A.1 of (Tang et al., 2013)).

1 = P1 = ρΘ1BΘT
1 Q1 =

−1/2
21 A21 onto ˆV1 ˆE

, and D

−1/2
1

√

(cid:13)(cid:13)(cid:13) ˆV1 − V1 ˆO1

(cid:13)(cid:13)(cid:13)F

(cid:18) K 3/2

√

(cid:19)

= OP

,

and

ρn

(cid:13)(cid:13)(cid:13)R1E1/2

1

(cid:13)(cid:13)(cid:13)F

(cid:16)

ˆO1 − ˆE1/2

1

= OP

K 3/2/β2

min

(cid:17)

βmin
with probability larger than 1 − O(K 2/n3).

On Mixed Memberships and Symmetric Nonnegative Matrix Factorizations

(cid:13)(cid:13)(cid:13)F

(cid:13)(cid:13)(cid:13)F

1 RT
1

1 RT
1

−1/2
1

− √
ρ · eT
i Θ2B1/2QT
− √
−1/2
1 V1 ˆO1 ˆE
1
(cid:17)T
V1 ˆO1 ˆE

ρ · eT
−1/2
1

B1/2ΘT
1

V1E1/2

1 Q1

i Θ2B1/2QT
ρ · eT
− eT
− eT

− √
−1/2
V1 ˆO1 ˆE
1
−1/2
1

(cid:17) ˆE

i Θ2B1/2QT

1 RT
1

i Θ2B1/2QT

1 RT
1

(cid:17)
(cid:16)
(cid:16)
(cid:13)(cid:13)(cid:13)F
(cid:13)(cid:13)(cid:13)F

(cid:13)(cid:13)(cid:13)F
(cid:13)(cid:13)(cid:13)(cid:13)F
(cid:13)(cid:13)(cid:13)F
(cid:33)

=

=

=

=

=

ρ ·

√
√

ρ · eT

i Θ2BΘT

Then we have:

i P21V1 ˆO1 ˆE

ρ · eT
ρ · eT

(cid:13)(cid:13)(cid:13)eT
(cid:13)(cid:13)(cid:13)ρ · eT
(cid:13)(cid:13)(cid:13)ρ · eT
i Θ2B1/2(cid:16)
(cid:13)(cid:13)(cid:13)(cid:13)eT
i Θ2B1/2(cid:16)
ρ ·(cid:13)(cid:13)(cid:13)eT
(cid:13)(cid:13)(cid:13)√
≤(cid:13)(cid:13)(cid:13)√
≤(cid:13)(cid:13)(cid:13)√
=⇒(cid:13)(cid:13)(cid:13)eT
(cid:13)(cid:13)(cid:13)eT
≤(cid:13)(cid:13)(cid:13)eT
(cid:16)
≤(cid:16)
(cid:18)

−1/2
21 A21 ˆV1 ˆE

i P21V1 ˆO1 ˆE

i A21 ˆV1 ˆE

Now that

−1/2
1

1 + OP

1 + OP

+ OP

i D

≤

+

≤

1 + OP

βmin

+OP

K

K

1

min

1

1

1 RT
1

1 RT
1

1 RT
1

(cid:13)(cid:13)(cid:13)

1

1

1 RT
1

=

1 RT
1

1 RT
1

· OP

1 + OP

βminρn

−1/2
1

−1/2
1

−1/2
1

ρ · eT

ρ · eT

K 3/2/β2

− √

R1E1/2

R1E1/2

i D−1/2

(cid:13)(cid:13)(cid:13)√

i Θ2B1/2QT

i Θ2B1/2QT

i Θ2B1/2QT

i Θ2B1/2QT

i Θ2B1/2QT

i Θ2B1/2QT

i P21V1 ˆO1 ˆE

ˆO1 − ˆE1/2

1 RT
1
ρ · eT

21 Θ2B1/2QT

ˆO1
ˆO1 − ˆE1/2

i Θ2B1/2QT
−1/2
1

(cid:13)(cid:13)(cid:13)R1E1/2
(cid:16)

(cid:13)(cid:13)(cid:13)F
(cid:17) ˆE
(cid:13)(cid:13)(cid:13)(cid:13)(cid:13)(cid:13) ˆE
(cid:32)(cid:115)
(cid:17) · OP
(cid:13)(cid:13)(cid:13)F
(cid:13)(cid:13)(cid:13)F
(cid:13)(cid:13)(cid:13)F
− √
(cid:16)
(cid:17)(cid:17) − √
(cid:16)(cid:112)K log n/nρ
/(cid:112)D21(i, i)
ρ · eT
(cid:17)(cid:17) ·(cid:13)(cid:13)(cid:13)eT
(cid:16)(cid:112)K log n/nρ
(cid:104)
(cid:16) ˆV1 − V1 ˆO1
(cid:17)
(cid:105) ˆE
(cid:112)D21(i, i)
(cid:17) ·(cid:13)(cid:13)(cid:13)√
(cid:13)(cid:13)(cid:13)F
(cid:16)(cid:112)K log n/nρ
/(cid:112)D21(i, i)
(cid:17)(cid:17) ·(cid:110)(cid:13)(cid:13)(cid:13)eT
(cid:13)(cid:13)(cid:13)F
(cid:13)(cid:13)(cid:13)eT
(cid:16) ˆV1 − V1 ˆO1
(cid:17) ˆE
(cid:16)(cid:112)K log n/nρ
i Θ2B1/2QT
(cid:13)(cid:13)(cid:13)eT
(cid:13)(cid:13)(cid:13)F
(cid:17)
(cid:16)
(cid:111)
/(cid:112)D21(i, i) + OP
K(cid:112)log n/n2ρ
i (A21 − P21) ˆV1 ˆE
− √
i Θ2B1/2QT
(cid:32)(cid:115)
(cid:33)
(cid:40)
(cid:19)(cid:19)
(cid:18) 1
(cid:17) · OP
(cid:16)(cid:112)Klog n
(cid:112)K log n/nρ
(cid:32)(cid:115)
(cid:33)(cid:41)
(cid:18)(cid:114) ρn
(cid:19)
(cid:19)
(cid:18) K 3/2
/(cid:112)βminρn/K
(cid:33)
(cid:32)
(cid:17)
K(cid:112)log n/n2ρ
(cid:13)(cid:13)(cid:13)eT

· OP
K 5/2√
β5/2
minρn

(A21 − P21) ˆV1 + P21

(cid:114)
(cid:32)

i Θ2B1/2QT

+ P21V1 ˆO1

(cid:13)(cid:13)(cid:13)F

(cid:13)(cid:13)(cid:13)2

ρ · eT

ρ · eT

−1/2
1

−1/2
1

βminρn

βmin

ρn

βminρn

K 2
√

(cid:33)

β5/2
min

+

i P21

· OP

· OP

(cid:16)

·

OP

2K
n

1 RT
1

1 RT
1

+ OP

ρn

1 RT
1

log n

√

K

K

i

+

=OP

.

(cid:13)(cid:13)(cid:13)F

i (A21 − P21) on a ﬁxed
In the last step we use the fact that
unit vector (since the eigenvectors come from the different partition of the graph). Now Azuma’s inequality gives
√
= OP (

K log n) with probability larger than 1 − O(1/n3).

is a sum of K projections of eT

i (A21 − P21) ˆV1

i (A21 − P21) ˆV1

F

(cid:13)(cid:13)(cid:13)eT

(by P21 = ρΘ2BΘT
1 )

(by Lemma A.1 of (Tang et al., 2013))

(by Lemmas 4.1, C.6, C.7 and C.10)

(cid:32)

K 2
√

β5/2
min

ρn

(cid:33)

.

(2)

1 RT
1

· OP

(by Lemma C.6)

− √

ρ · eT

−1/2
1

i Θ2B1/2QT

1 RT
1

(cid:13)(cid:13)(cid:13)F

(cid:13)(cid:13)(cid:13)F

−1/2
1

(by Lemmas 4.1 and C.6)

(by Azuma’s and Lemma C.7)

(by Lemmas C.6, C.8, and Eq. (2))

On Mixed Memberships and Symmetric Nonnegative Matrix Factorizations

Now as

(cid:13)(cid:13)(cid:13)√

21 Θ2B1/2(cid:13)(cid:13)(cid:13)2

F

ρ · eT

i D−1/2

let O = QT

1 RT

1 , then ∀i,
−1/2
21 A21 ˆV1 ˆE

(cid:13)(cid:13)(cid:13)eT

i D

(cid:13)(cid:13)(cid:13)√

ρ · eT

− √
−1/2
1
i D−1/2
21 Θ2B1/2

i D−1/2

(cid:13)(cid:13)(cid:13)F

ρ · eT

ρ · eT

(cid:19)

i Θ2BΘT
D21(i, i)

2 ei

(cid:18) K

(cid:19)

= OP

,

n

ρn/K

=

=

F

=

D21(i, i)

i Θ2B1/2(cid:13)(cid:13)2
ρ(cid:13)(cid:13)eT
(cid:18) ρ
(cid:13)(cid:13)(cid:13)F

P2(i, i)
D21(i, i)

= Ω

21 Θ2B1/2O

= OP

(cid:33)

(cid:114) n

K

·

(cid:32)
(cid:32)

K 5/2√
β5/2
minρn
K 2√
β5/2
minρ

log n
√

n

log n

(cid:33)

with probability larger than 1 − n · O(K 2/n3)=1 − O(K 2/n2).

= OP

D. Correctness of Pure node clusters

Proof of Lemma 4.3. Recall that maxi (cid:107)Xi(cid:107) concentrates around(cid:112)2K/n and this is achieved at the pure nodes. For ease
of analysis let us introduce ˆY := (cid:112)n/2K ˆX and Y = (cid:112)n/2KX. Recall that from Theorem 4.2 we have entry-wise

consistency on (cid:107) ˆYi − YiO(cid:107) ≤ (cid:48) = OP

with probability larger than 1 − OP (K 2/n2).

(cid:19)

(cid:18)

K2√
β5/2
minρ

√
log n
n

Let norm = OP

= OP ((cid:48)) be the error of the norm of pure nodes in Lemma 4.1. Then ∀i ∈ F,

(cid:18)(cid:113) K log n

(cid:19)

n

(cid:107)Xj(cid:107) ≥ (1 − 0)(1 − (cid:48))(1 − norm)(cid:112)2K/n.

(cid:107) ˆXi(cid:107) ≥ (1 − 0) max

j

(cid:107) ˆXj(cid:107) ≥ (1 − 0)(1 − (cid:48)) max

j

Hence we have a series of inequalities,

(1 − 0)(1 − (cid:48))(1 − norm) ≤ (cid:107) ˆYi(cid:107) ≤ (cid:107) ˆYi − YiO(cid:107) + (cid:107)Yi(cid:107) ≤ (cid:48) + (cid:107)Yi(cid:107).

Hence

(cid:107)Yi(cid:107)2 ≥ (1 − 0 − 2(cid:48) − norm)2 ≥ 1 − 2(0 + 2(cid:48) + norm)

And from the proof of Lemma 4.1,

1 − 2(0 + 2(cid:48) + norm) ≤ (cid:107)Yi(cid:107)2 ≤

(cid:80)
(cid:80)

a∈[K] θ2
iaBaa
a∈[K] θiaBaa

≤ max

a

θia (1 + norm)

=⇒ max

a

θia ≥ 1 − 2(0 + 2(cid:48) + 1.5norm) = 1 − OP (0 + (cid:48))

for  = 2(0 + 2(cid:48) + 1.5norm) = OP (0 + (cid:48)), with probability larger than 1 − OP (K 2/n2).
Note that (cid:107)Xi(cid:107)2 of those nearly pure nodes with maxa θia ≥ 1 −  also concentrate around 2K
can also be used along with the pure nodes to recover the MMSB model asymptotically correctly.
Lemma D.1. Let F be the set of nodes with (cid:107) ˆXi(cid:107) ≥ (1 − 0) maxj (cid:107) ˆXj(cid:107). Then when 0 = OP ((cid:48)) and  = OP (0 + (cid:48))
from Lemma 4.3,

n . These nearly pure nodes

i∈F D2(i, i) =
min

(βmin ± OP ()) ,

ρn
2K

and max

i∈F D2(i, i) =

(1 ± OP ())

ρn
2K

with probability larger than 1 − OP (K 2/n2).

n/2(cid:88)
K(cid:88)

j=1

(cid:96)=1

= ρ

=

=

ρn
2K
ρn
2K

n/2(cid:88)

j=1

K(cid:88)
(cid:32)

(cid:96)=1

θ(2)
i(cid:96) B(cid:96)(cid:96)

n
2K

1±OP

((1 − OP ())Baiai + OP ())
(Baiai ± OP ()) .

(cid:32)(cid:114)

K(cid:88)
(cid:33)(cid:33)

(cid:96)=1

K log n

n

(cid:32)

1 ± OP

(cid:16)(cid:113) K log n

(cid:104)
(Baiai ± OP ()) .

1 − OP

ρn

D2(i, i) =

ρn
2K

j=1

(cid:32)(cid:114)

(cid:33)(cid:33)

K log n

n

(from Lemma C.1)

(cid:17)

, 1 + OP

(cid:16)(cid:113) K log n

(cid:17)(cid:105)

ρn

, so

On Mixed Memberships and Symmetric Nonnegative Matrix Factorizations

Proof. From Lemma 4.3 we know that ∀i ∈ F, ∃ai that θiai ≥ 1 − , where  = OP (0 + (cid:48)) = OP ((cid:48)). Then

D2(i, i) =

Pij =

ρθ(2)

i(cid:96) B(cid:96)(cid:96)θ(2)

j(cid:96) = ρ

θ(2)
i(cid:96) B(cid:96)(cid:96)

θ(2)
j(cid:96)

n/2(cid:88)

Using the proof in Lemma C.6, we have D2(i, i) ∈ D2(i, i)

Then

i∈F D2(i, i) =
min
max
i∈F D2(i, i) =
with probability larger than 1 − OP (K 2/n2).

(βmin ± OP ()) ,
(1 ± OP ())

ρn
2K
ρn
2K

Proof of Theorem 4.4. To prove this theorem, it is equivalent to prove that the upper bound of Euclidean distances within
each community’s (nearly) pure nodes is far more smaller than the lower bound of Euclidean distances between different
communities’ (nearly) pure nodes.
Recall that from Lemma 4.3, for i (cid:54)= j ∈ F, ∃ a, b ∈ [K], such that θia ≥ 1−  and θjb ≥ 1− . Note that  = OP (0 + (cid:48))
for (cid:48) = OP

and 0 = OP ((cid:48)).

(cid:18)

(cid:19)

K2√
β5/2
minρ

√
log n
n

Using a similar argument as in the proof of Lemma 4.1, we have:

(cid:32)
(cid:33)2(cid:35)
(cid:32)(cid:114)

·

1 − OP

K log n

(cid:33)(cid:33)2

K log n

n

(cid:32)(cid:114)
(cid:33)(cid:33)

1. if a (cid:54)= b,

(cid:107)Yi − Yj(cid:107)2

2 ≥

≥

≥

≥

(cid:34)(cid:32)
(cid:34)
(cid:34)
2
(cid:40)

Baa

2βmin

βmax

θiaB1/2
aa

k θikBkk

(cid:112)(cid:80)
(cid:18) 1 − √
(cid:18) 1 − √
(cid:34)
(cid:32)
(cid:32)
(cid:34)
(cid:32)

βmin
βmax

βmin
βmax

1 − 2

(cid:32)

1 −

βmax

− θjaB1/2

aa

k θjkBkk

(cid:112)(cid:80)
− √

+

+ Bbb

(cid:33)2

βmax
1 − OP

(cid:32)
(cid:112)(cid:80)
(cid:19)2
(cid:18) 1 − √
(cid:19)2(cid:35)
(cid:32)(cid:114)
(cid:32)
(cid:35)2 ·
(cid:32)
(cid:33)
(cid:33)
(cid:33)(cid:33)

 + OP (2)

(cid:35)(cid:41)

1 − OP

βmax
βmin

·



βmin
− √

βmin

1 +

βmax
βmin

(cid:115)
(cid:115)
(cid:115)

=

2

1 +

= 2

βmin
βmax

1 − OP



βmax
βmin

.

θibB1/2
bb

−

(cid:112)(cid:80)
(cid:19)2(cid:35)
·
(cid:33)(cid:33)

k θikBkk
− √

βmin

K log n

θjbB1/2
bb

(cid:32)

k θjkBkk
1 − OP

n

(cid:32)(cid:114)
(cid:32)

(cid:33)(cid:33)
(cid:32)(cid:114)

K log n

n

·

1 − OP

K log n

n

n

(cid:33)(cid:33)

So,

and then,

(cid:13)(cid:13)(cid:13) ˆXi − ˆXj

(cid:13)(cid:13)(cid:13)2

On Mixed Memberships and Symmetric Nonnegative Matrix Factorizations

(cid:33)(cid:33)

,

βmax
βmin



(cid:115)
(cid:13)(cid:13)(cid:13)2

1 − OP

(cid:32)
(cid:32)
−(cid:13)(cid:13)(cid:13) ˆXj − Xj
(cid:115)
(cid:33)(cid:33)
(cid:115)
(cid:33)(cid:33)

βmax
βmin

βmax
βmin

2K
n

(cid:13)(cid:13)(cid:13)2
(cid:32)
(cid:32)
(cid:33)





2

(cid:115)

≥

βmin
βmax

(cid:107)Xi − Xj(cid:107)2 ≥

(cid:114)
≥ (cid:107)Xi − Xj(cid:107)2 −(cid:13)(cid:13)(cid:13) ˆXi − Xi
(cid:115)
(cid:115)
(cid:114)

(cid:32)
(cid:32)
(cid:32)
(cid:114)
(1 − )βa ≤(cid:88)

(cid:114)
(cid:114)

1 − OP

1 − OP

βmin
βmax

βmin
βmax

− OP

2K
n

2K
n

Kβmin

≥

n

2

2



K
n

θikBkk ≤ βa + 

k

(cid:32)

·

(cid:33)2
2
(cid:80)

1 + OP

(cid:88)

k(cid:54)=a

+

βmax
βmin

θjlB1/2

ll

k θjkBkk

(1 − )B1/2

aa

(cid:112)(cid:80)
βa + (cid:80)
(cid:18)
(cid:19)

k(cid:54)=a βk

1 − 
2

(cid:21)2

+ OP (2)

k(cid:54)=a βk
βa

(cid:18)

βk,

k(cid:54)=a

K log n

(cid:88)
(cid:33)(cid:33)2
(cid:32)(cid:114)
 · (1 + OP ())
(cid:19)(cid:21)2
(cid:19)(cid:41)

2

n

+ (K − 1)

 + OP (2)

+ OP

K

βmax
βmin

2

· (1 + OP ())

= 2

2. if a = b, ﬁrst of all we have

then

(cid:107)Yi − Yj(cid:107)2

2 =

≤

=

≤

k θikBkk

−

(cid:113)

−

θilB1/2

l

ll

(cid:32)
(cid:88)
(cid:112)(cid:80)

 B1/2
aa(cid:112)(1 − )βa
(cid:40)(cid:20)
(cid:40)(cid:20)(cid:18) 3
(cid:80)
(cid:18)

1 +


2

+

2

k(cid:54)=a βmax
2βmin

(cid:19)

2

.

= OP

K

βmax
βmin

So,

and then,

(cid:13)(cid:13)(cid:13) ˆXi − ˆXj

(cid:13)(cid:13)(cid:13)2

+ OP (2) − (1 − )

− 2(cid:107)Xi(cid:107) · (cid:48)

(cid:114)

− 2

· (1 + OP ()) · (cid:48)

2K
n

.

(βmax = 1 by deﬁnition)

(cid:41)

βmax
βmin

2

· (1 + OP ())



OP

2K
n

(cid:107)Xi − Xj(cid:107)2 ≤

(cid:115)
(cid:32)
(cid:114)
(cid:13)(cid:13)(cid:13) ˆXi − Xi
(cid:13)(cid:13)(cid:13)2
(cid:115)
(cid:32)
(cid:33)
(cid:114)
≤ (cid:107)Xi − Xj(cid:107)2 +
≤
(cid:115)
(cid:33)
(cid:32)
(cid:114)

βmax
βmin

2K
n

OP

K



K

βmax
βmin

(cid:33)
(cid:13)(cid:13)(cid:13) ˆXj − Xj
(cid:114)

+ 2(cid:107)Xi(cid:107) · (cid:48)

+

(cid:13)(cid:13)(cid:13)2

≤

2K
n

(cid:32)

OP

(cid:115)



βmax
βmin

K

(cid:33)

K 2

nβmin

+ 2

2K
n

· (1 + OP ()) · (cid:48)

= OP



.

(βmax = 1 by deﬁnition)

On Mixed Memberships and Symmetric Nonnegative Matrix Factorizations

(cid:113) Kβmin

n

Now we can see 1
can be used as a threshold to separate different clusters. However, in the algorithm we do not
2
know βmin in advance, so we need to approximate it with some computable statistics. From Lemma D.1, we know that
2K (Baiai ± OP ((cid:48))) when θiai ≥ 1 − . So mini∈F D2(i, i) and maxi∈F D2(i, i) can be used to estimate
D2(i, i) = ρn
(cid:115)
βmin.

(cid:115)

(cid:115)

(cid:33)

(cid:32)

(cid:114)

K
4n

mini∈F D2(i, i)
maxi∈F D2(i, i)

=

ρn (βmin ± OP ()) /(2K)
ρn (1 ± OP ()) /(2K)

K
4n

=

1
2

Kβmin

± OP



n

K

nβmin

.

τ =

Clearly,

(cid:114)

2

Kβmin

n

± OP

(cid:33)

(cid:32)

(cid:114)



K
n

> 2τ (cid:29) OP

(cid:32)

(cid:115)



(cid:33)

,

K 2

nβmin

which means PartitionPureNodes( ˆX(F, :), τ) can exactly give us K clusters of different (nearly) pure nodes and return
one (nearly) pure node from each of the K clusters with probability larger than 1 − OP (K 2/n2).

E. Consistency of inferred parameters

Proof of Theorem 4.5. Let ˆY :=(cid:112)n/2K ˆX and Y =(cid:112)n/2KX. Let  = OP (0 + (cid:48)) = O ((cid:48)) from Lemma 4.3, where

we show that (cid:107)Yi(cid:107)2 ≥ 1−  for i ∈ SP . Furthermore for ease of exposition let us assume that the pure nodes are arranged
so that ˆΘ2p = ˆΘ2(Sp, :) is close to an identity matrix, i.e., the columns are arranged with a particular permutation.
Thus (cid:107)Yp(cid:107)2
We have also shown that (cid:107)Yp(i, :)(cid:107)2 ≤ 1 + , so (cid:107)Yp(cid:107)F ≤ √

i (cid:107)Yp(i, :)(cid:107)2 ≥ K(1 − ) and so (cid:107)Yp(cid:107)F ≥(cid:112)K(1 − ).

F =(cid:80)

K (1 + ).

We will use

(cid:107) ˆY −1

p − (YpO)

−1 (cid:107)F ≤ (cid:107) (YpO)

−1 (YpO − ˆYp) ˆY −1

p (cid:107)F ≤ (cid:107)Y−1

p (cid:107)F(cid:107)YpO − ˆYp(cid:107)F(cid:107) ˆY −1
p (cid:107).

(3)

First we will prove a bound on (cid:107) ˆY −1

p (cid:107). Let ˆσi be the ith singular value of ˆYp,

(4)
We can bound ˆσK by bounding σK. In what follows we use M1p to denote the rows of M1 indexed by Sp when M1
is n/2 × K and by the square submatrix M1(Sp,Sp) is when M1 is n/2 × n/2. Note that (cid:107)Θ2p − I(cid:107)F =
√
K,
(cid:107)B1/2(cid:107)F = OP (

√
K), (cid:107)Θ2p(cid:107)F = OP (

21p(cid:107)F = OP (K 3/2/βminρn),

√

.

(cid:107) ˆY −1

p (cid:107) =

1
ˆσK

K) and (cid:107)D−1
λi(D−1/2
21pΘ2pB1/2)
21p + (Θ2p − I)TD−1

ρn
2K
2pD−1

21p Θ2pBΘT

2pD−1/2
21p )

σ2
i = λi(YpYT

p ) =

=

(cid:16)

λi(B1/2ΘT

ρn
2K
ρn
2K
Note that the matrix B1/2D−1
21pB1/2 is a diagonal matrix with the (i, i)th diagonal element being βi/D21p(i, i).
With similar arguments in the proof of Lemma D.1, we can get

21p(Θ2p − I)(cid:1) B1/2(cid:17)

B1/2(cid:0)D−1

21pΘ2p + D−1

λi

=

.

so

D21p(i, i) =

nρ
2K

(βi ± OP ()) ,

λK(B1/2D−1

21pB1/2) =

2K
ρn

(1 ± OP (/βmin)) .

By Weyl’s inequality and note that operator norm is less than or equal to Frobenius norm, it immediately gives us:

(cid:12)(cid:12)(cid:12)σ2

(cid:16)

21pB1/2(cid:17)(cid:12)(cid:12)(cid:12) ≤ ρn

i − ρn
2K

λi

B1/2D−1

On Mixed Memberships and Symmetric Nonnegative Matrix Factorizations

21pΘ2pB1/2 + B1/2D−1

21p(Θ2p − I)B1/2(cid:13)(cid:13)(cid:13)
· 2(cid:107)Θ2p(cid:107)F ·(cid:13)(cid:13)(cid:13)B1/2(cid:13)(cid:13)(cid:13)F
(cid:19)

(cid:13)(cid:13)F

√

K

K ·

2K
≤ ρn
2K

=OP

=OP

· (cid:107)Θ2p − I(cid:107)F ·(cid:13)(cid:13)D−1
(cid:33)

·(cid:13)(cid:13)(cid:13)B1/2(Θ2p − I)TD−1
·(cid:13)(cid:13)(cid:13)B1/2(cid:13)(cid:13)(cid:13)F
(cid:18) ρn
√
(cid:32)
·
K 9/2√
log n
(cid:32)
√
β7/2
minρ
K 9/2√
log n
√
β7/2
minρ

K · K 3/2
βminρn

(cid:33)

K ·

√

√

2K

n

n

·

.

21p

=⇒ σ2

K =1 ± OP

Now, Weyl’s inequality for singular values gives us:

|ˆσi − σi| ≤ (cid:107) ˆYp − YpO(cid:107) ≤ (cid:107) ˆYp − YpO(cid:107)F = OP (

(cid:32)

(cid:32)

K 9/2√
log n
√
β7/2
minρ
Plugging this into Equation (4) we get:

1 ± OP

ˆσK =

n

(cid:33)(cid:33)1/2(cid:32)

1 ± OP

√

K)

(cid:32)√
(cid:32)

(cid:107) ˆY −1

p (cid:107) = 1 ± OP

(cid:33)

.

K 9/2√
β7/2
minρ

log n
√

n

K · K 2√

log n
√

n

β5/2
minρ

(cid:33)(cid:33)

(cid:32)

= 1 ± OP

(cid:33)

.

K 9/2√
β7/2
minρ

log n
√

n

Finally putting everything together with Equation (3) we get:
−1 (cid:107)F

(cid:107) ˆY −1

−1 (cid:107)F

(cid:107) ˆX−1

p − (XpO)
p (cid:107)F

(cid:107)X−1

=

p − (YpO)
p (cid:107)F

(cid:107)Y−1

≤ (cid:107)YpO − ˆYp(cid:107)F(cid:107) ˆY −1

p (cid:107) = OP

(cid:32)

K 5/2√
β5/2
minρ

log n
√

n

(cid:33)

(5)

with probability larger than 1 − OP (K 2/n2).
(Sp,Sp). First note that if one plugs in the population
Proof of Theorem 4.6. Recall that ˆΘ2 = ˆΘ( ¯S) = D1/2
counterparts of the the terms in ˆΘ2, then for some permutation matrix Π that Θ2p := Θ2(Sp, :) · Π is close to an identity
matrix, and

ˆX ˆX−1

−1/2
21

p D

12

(cid:16)√

21 Θ2B1/2(cid:17)(cid:18) 1√

ρ · D−1/2

ρ

(cid:19)

· B−1/2ΠΘ−1

2p D1/2

21p

D−1/2
21p = Θ2ΠΘ−1
2p ,

D1/2
21 XX−1

p D−1/2

21p = D1/2

21

so

Θ2Π = D1/2

21 XX−1

p D−1/2

21p Θ2p.

We have the following decomposition

(cid:13)(cid:13)(cid:13) ˆΘ2 − Θ2Π
(cid:13)(cid:13)(cid:13)F

(cid:13)(cid:13)(cid:13)F
From the proof of Lemma C.6 we have(cid:112)D21(i, i) =(cid:112)D21(i, i)(1 ± OP ((cid:112)K log n/nρ)) and hence

21 − D1/2
21 XO( ˆX−1
21 XX−1

+
−1/2
−1)D
21p
(I − Θ2p)

21 ( ˆX − XO) ˆX−1
p D
21 XX−1

(cid:13)(cid:13)(cid:13)D1/2
(cid:13)(cid:13)(cid:13)F

21 ) ˆX ˆX−1
p D

p − (XpO)

p D−1/2

(cid:13)(cid:13)(cid:13)F

−1/2
21p

p (D

−1/2
21p
21p − D−1/2
−1/2
21p )

21p

+

(cid:13)(cid:13)(cid:13)F

+

(cid:13)(cid:13)(cid:13)D1/2
(cid:13)(cid:13)(cid:13)F
(cid:13)(cid:13)(cid:13) OP ((cid:112)K log n/nρ),

.

≤(cid:13)(cid:13)(cid:13)(D1/2
(cid:13)(cid:13)(cid:13)D1/2
(cid:13)(cid:13)(cid:13)D1/2
(cid:13)(cid:13)(cid:13)D1/2

+

(cid:13)(cid:13)(cid:13) =

(cid:13)(cid:13)(cid:13)D1/2

21

21 − D1/2

21

and

On Mixed Memberships and Symmetric Nonnegative Matrix Factorizations

p (cid:107) = (cid:112)n/(2K)(cid:107) ˆY −1

(cid:13)(cid:13)(cid:13)D
p (cid:107) = OP ((cid:112)n/K), as we have shown in the proof of Theorem 4.5. Furthermore, by

(cid:13)(cid:13)(cid:13) OP ((cid:112)K log n/nρ).

(cid:13)(cid:13)(cid:13) ≤(cid:13)(cid:13)(cid:13)D−1/2

−1/2
21p − D−1/2

21p

21p

n).

√
p (cid:107)F = OP (

And (cid:107) ˆX−1
Fact C.1, (cid:107) ˆX−1
√
From the proof of Theorem 4.2 we can get (cid:107) ˆX − XO(cid:107)F = OP (
K 5/2√
(cid:19)
β5/2
minρ
· OP

p (cid:107)F · OP
(cid:18)√

(cid:32)
(cid:114) n

−1 (cid:107)F = (cid:107)X−1

p − (XpO)

(cid:107) ˆX−1

= OP

K ·

(cid:32)

K

log n
√

n

(cid:33)
K 5/2√
β5/2
minρ

K(cid:48)). Theorem 4.5 gives

(cid:33)

(cid:32)

= OP

(cid:33)

.

K 5/2√
β5/2
minρ

log n

log n
√

n

K), since it concentrates around its population entry-wisely, and the max norm of any row of the

√
Also (cid:107) ˆX(cid:107)F = OP (

population is(cid:112)2K/n, so (cid:107)X(cid:107)F = OP (

√

OP

p

p

= OP

√

21

21

K

−1/2
21p

−1/2
21p

−1/2
21p

K). And

(cid:107)D1/2

ρ · D−1/2

21 X(cid:107) = (cid:107)D1/2

ρ · Θ2B1/2(cid:107) =(cid:112)(cid:107)P(cid:107) = OP ((cid:112)ρn/K).
21 Θ2B1/2(cid:107) = (cid:107)√
(cid:13)(cid:13)(cid:13)
(cid:13)(cid:13)(cid:13)F
(cid:13)(cid:13)(cid:13) ˆX−1
(cid:13)(cid:13)(cid:13)(cid:13)(cid:13)(cid:13) ˆX
≤(cid:13)(cid:13)(cid:13)D1/2
(cid:13)(cid:13)(cid:13)(cid:13)(cid:13)(cid:13)D
(cid:13)(cid:13)(cid:13)F
(cid:17)
(cid:17) · OP ((cid:112)K/βminρn) = OP
(cid:17) · OP
(cid:17) · OP
(cid:16)√
(cid:16)(cid:112)n/K
(cid:16)(cid:112)K log n/nρ
21 − D1/2
21 − D1/2
21 ) ˆX ˆX−1
p D
(cid:13)(cid:13)(cid:13)
(cid:13)(cid:13)(cid:13)F
(cid:13)(cid:13)(cid:13)F
(cid:13)(cid:13)(cid:13)(cid:13)(cid:13)(cid:13) ˆX − XO
≤(cid:13)(cid:13)(cid:13)D1/2
(cid:13)(cid:13)(cid:13) ˆX−1
(cid:13)(cid:13)(cid:13)(cid:13)(cid:13)(cid:13)D
(cid:18)(cid:114) n
(cid:17) · OP
(cid:17) · OP ((cid:112)K/βminρn) = OP
(cid:16)√
K(cid:48)(cid:17) · OP
(cid:16)(cid:112)n/K
21 ( ˆX − XO) ˆX−1
p D
−1(cid:13)(cid:13)(cid:13)F
≤(cid:13)(cid:13)(cid:13)D1/2
(cid:13)(cid:13)(cid:13)F
(cid:13)(cid:13)(cid:13)
(cid:13)(cid:13)(cid:13)D
(cid:13)(cid:13)(cid:13)(cid:13)(cid:13)(cid:13) ˆX−1
(cid:32)
(cid:33)
(cid:19)
(cid:18) K 5/2√
−1)D
p − (XpO)
(cid:17) · OP
· OP ((cid:112)K/βminρn) = OP
K 5/2√
(cid:13)(cid:13)(cid:13)F
(cid:13)(cid:13)(cid:13)(cid:13)(cid:13)D
(cid:13)(cid:13)(cid:13)(cid:13)(cid:13)X−1
≤(cid:13)(cid:13)(cid:13)D1/2
β5/2
minρ
(cid:17) · OP (
(cid:17)
(cid:16)(cid:112)K log n/nρ
K ·(cid:112)n/K) · OP ((cid:112)K/βminρn)OP
21p − D−1/2
−1/2
21p )
(cid:13)(cid:13)(cid:13)F
(cid:13)(cid:13)(cid:13)(cid:13)(cid:13)D−1/2
(cid:13)(cid:13)(cid:13)(cid:13)(cid:13)X−1
≤(cid:13)(cid:13)(cid:13)D1/2
(cid:32)(cid:115)
(cid:107)I − Θ2p(cid:107)F
(cid:17) · OP (
K ·(cid:112)n/K) · OP ((cid:112)K/βminρn) ·

Hence,(cid:13)(cid:13)(cid:13)(D1/2
(cid:16)(cid:112)ρn/K
(cid:13)(cid:13)(cid:13)D1/2
(cid:16)(cid:112)ρn/K
(cid:13)(cid:13)(cid:13)D1/2
(cid:16)(cid:112)ρn/K
(cid:13)(cid:13)(cid:13)D1/2
(cid:16)(cid:112)ρn/K
(cid:13)(cid:13)(cid:13)D1/2
(cid:16)(cid:112)ρn/K

β3
minρ
21p − D−1/2
−1/2

(I − Θ2p)
√

(cid:17)
(cid:16)(cid:112)K log n/βminρ
(cid:33)
(cid:18) K 5/2√

(cid:13)(cid:13)(cid:13)F
(cid:13)(cid:13)(cid:13)F

p − (XpO)

21 X( ˆX−1

21 XX−1

21 XX−1

p D−1/2

K(cid:48) = OP

βmin
−1/2
21p

(cid:48)(cid:19)

−1/2
21p

−1/2
21p

β3
minρ

21 X

p

21 X

p

log n

,

21p

√

p (D

21 X

= OP

= OP

= OP

log n

= OP

= OP

= OP

√

21p

21p

21

(cid:48)

Kn
βmin

,

(cid:19)

.

log n

β3
minρ

(cid:17)

,

(cid:16)(cid:112)K log n/βminρ
(cid:19)
(cid:18) K 2√

log n

,

= OP

So

Since (cid:107)Θ2(cid:107)2

(cid:13)(cid:13)(cid:13) ˆΘ2 − Θ2Π
(cid:13)(cid:13)(cid:13)F
F = Ω(n/K), we ﬁnally have:(cid:13)(cid:13)(cid:13) ˆΘ2 − Θ2Π
(cid:13)(cid:13)(cid:13)F

(cid:107)Θ2(cid:107)F

(cid:18) K 5/2√

log n

β3
minρ

= OP

(cid:18) K 3√

√
log n
n

β3
minρ

≤ OP

.

(cid:19)

(cid:19)

with probability larger than 1 − O(K 2/n2).

On Mixed Memberships and Symmetric Nonnegative Matrix Factorizations

Proof of Theorem 4.7. Recall that ˆρ ˆβa =
Θ2(Sp, :) · Π is close to an identity matrix, if one plugs in the population counterparts of the the terms in ˆΘ2,

, and for some permutation matrix Π that Θ2p :=

a D1/2

F

a ΠT B1/2(cid:13)(cid:13)(cid:13)F

√

ρ · eT

ρ · eT

(cid:13)(cid:13)(cid:13)√

a (Θ2p − I) ΠT B1/2 +
ρ · eT

a ΠT B1/2(cid:13)(cid:13)(cid:13)F

+

(cid:13)(cid:13)(cid:13)eT
(cid:18)(cid:114) nρ

(cid:19)
i ( ˆX − XO)

(cid:13)(cid:13)(cid:13)

· OP

K

(cid:32)(cid:112)K 5 log n

(cid:33)

β5/2
minρn

=

=

√

a D1/2

(cid:13)(cid:13)(cid:13)F

(cid:13)(cid:13)(cid:13)eT

ρ · eT
ρ · eT

21 (Sp,Sp) ˆXp

21 (Sp,Sp)Xp

=
where a(cid:48) ∈ [K] satisﬁes Πa(cid:48)a = 1.
Using the bounds mentioned in the proof of Theorem 4.6, we have:

(cid:13)(cid:13)(cid:13)2
(cid:13)(cid:13)(cid:13)eT
(cid:13)(cid:13)(cid:13)√
(cid:13)(cid:13)(cid:13)√
a Θ2pΠT B1/2(cid:13)(cid:13)(cid:13)F
≤(cid:13)(cid:13)(cid:13)√
a (Θ2p − I) ΠT B1/2(cid:13)(cid:13)(cid:13)F
ρ(cid:48) +(cid:112)ρβa(cid:48),
(cid:13)(cid:13)(cid:13)eT
(cid:13)(cid:13)(cid:13)eT
(cid:13)(cid:13)(cid:13) =
≤(cid:13)(cid:13)(cid:13)(cid:16)(cid:112)D21(i, i) −(cid:112)D21(i, i)
(cid:17)
(cid:17)(cid:16)(cid:13)(cid:13)(cid:13)eT
≤(cid:16)(cid:112)D21(i, i) −(cid:112)D21(i, i)
(cid:32)(cid:115)
(cid:33)(cid:34)
(cid:33)

(cid:18)(cid:114) nρ
(cid:32)

ˆX − D1/2

β5/2
minρn

i (D1/2

i (D1/2

21 XO)

K log n

(cid:19)

eT
i

ˆX

= OP

OP

OP

nρ

K

21

i

21 ) ˆX + eT

21 − D1/2

21 ( ˆX − XO)

(cid:13)(cid:13)(cid:13)
(cid:13)(cid:13)(cid:13)(cid:112)D21(i, i)eT
(cid:13)(cid:13)(cid:13) +
(cid:13)(cid:13)(cid:13)
(cid:17)(cid:13)(cid:13)(cid:13) +(cid:13)(cid:13)eT
i X(cid:13)(cid:13)(cid:17)
(cid:16) ˆX − XO
+(cid:112)D21(i, i)
(cid:33)(cid:35)
(cid:32)(cid:114)
(cid:33)
(cid:32)(cid:112)K 5 log n

i D1/2
i ( ˆX − XO)

+ OP

+ OP

K
n

K 5/2 log n
β5/2
min

√

ρn

.

= OP

As a result,

and note that ρβa(cid:48) = Ω(ρ), we have

(cid:12)(cid:12)(cid:12)(cid:12)(cid:113)
(cid:12)(cid:12)(cid:12)(cid:12) ≤ OP
ˆρ ˆβa −(cid:112)ρβa(cid:48)
(cid:34)

ˆρ ˆβa ∈ ρβa(cid:48)

1 − OP

(cid:32)

(cid:33)

√

+

ρ(cid:48) = OP

(cid:32)

(cid:33)

,

K 5/2 log n
β5/2
min

√

ρn

K 5/2 log n
β5/2
min

√

ρn

(cid:32)

K 5/2 log n
√
β5/2
minρ

n

(cid:33)

(cid:32)

, 1 + OP

K 5/2 log n
√
β5/2
minρ

n

(cid:33)(cid:35)

with probability larger than 1 − O(K 2/n2).

References
Huang, Kejun, Sidiropoulos, Nicholas, and Swami, Ananthram. Non-negative matrix factorization revisited: Uniqueness

and algorithm for symmetric decomposition. Signal Processing, IEEE Transactions on, 62(1):211–224, 2014.

Lei, Jing, Rinaldo, Alessandro, et al. Consistency of spectral clustering in stochastic block models. The Annals of Statistics,

43(1):215–237, 2015.

Minc, Henryk. Nonnegative matrices. 1988.

Tang, Minh, Sussman, Daniel L, Priebe, Carey E, et al. Universally consistent vertex classiﬁcation for latent positions

graphs. The Annals of Statistics, 41(3):1406–1430, 2013.

Yu, Yi, Wang, Tengyao, Samworth, Richard J, et al. A useful variant of the davis–kahan theorem for statisticians.

Biometrika, 102(2):315–323, 2015.

